<form *ngIf="videoForm" [formGroup]="videoForm" (submit)="onSubmit()">
  <mat-form-field class="full-width">
    <input formControlName="id" maxLength="11" matInput placeholder="video id" autocomplete="off">
    <mat-hint *ngIf="!videoForm['controls']['id'].valid && videoForm['controls']['id'].touched">video id length must be 11 characters</mat-hint>
  </mat-form-field>

  <mat-checkbox formControlName="isDemo">Demo</mat-checkbox>

  <div class="form-wrap">
    <table mat-table [dataSource]="videoForm.get('timeKeys').controls" class="table-primary no-border">
      <ng-container matColumnDef="index">
        <th mat-header-cell *matHeaderCellDef class="index">â„–</th>
        <td mat-cell *matCellDef="let i = index" class="index">{{i + 1}}.</td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container formArrayName="timeKeys" matColumnDef="timeKeys" sticky>
        <th mat-header-cell *matHeaderCellDef class="time-keys">Time</th>
        <td mat-cell *matCellDef="let i = index" class="time-keys">
          <mat-form-field>
            <input #timeKey [formControlName]="i" type="number" step=".1" matInput>
          </mat-form-field>
          <p class="hidden">{{timeKey.value}}</p>
        </td>
        <td mat-footer-cell *matFooterCellDef>
          <button type="button" (click)="openParser('keys')" mat-raised-button color="primary">Parse</button>
        </td>
      </ng-container>

      <ng-container *ngFor="let lang of languages" formGroupName="subts" [matColumnDef]="lang">
        <ng-container [formArrayName]="lang">
          <th mat-header-cell *matHeaderCellDef class="subt">{{lang}}</th>
          <td mat-cell *matCellDef="let i = index">
            <mat-form-field>
              <input #en [formControlName]="i" matInput>
            </mat-form-field>
            <p class="hidden">{{en.value}}</p>
          </td>
          <td mat-footer-cell *matFooterCellDef>
            <button type="button" (click)="openParser(lang)" mat-raised-button color="primary">Parse</button>
            <button type="button" (click)="removeLanguage(lang)" mat-raised-button color="warn" class="remove-btn">Delete</button>
          </td>
        </ng-container>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let i = index">
          <div class="actions-wrap">
            <button type="button" (click)="removeSubt(i)" mat-raised-button color="warn">X</button>
            <button type="button" (click)="addSubt(i + 1)" mat-raised-button color="primary">+</button>
          </div>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['index', 'timeKeys'].concat(languages, 'actions')"></tr>
      <tr mat-row *matRowDef="let row; columns: ['index', 'timeKeys'].concat(languages, 'actions')"></tr>
      <tr mat-footer-row *matFooterRowDef="['index', 'timeKeys'].concat(languages, 'actions')"></tr>
    </table>
  </div>

  <mat-form-field>
    <mat-label>Add language</mat-label>
    <mat-select (selectionChange)="addLanguage($event.value)">
      <mat-option *ngFor="let lang of langs" [value]="lang">
        {{lang}}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <button [disabled]="videoForm.invalid || videoForm.pristine" color="primary" mat-raised-button>
    {{btnText || 'Update'}}
  </button>
</form>
